# ğŸ§ Ğ£Ğ¼Ğ½Ñ‹Ğ¹ ĞÑƒĞ´Ğ¸Ğ¾Ğ³Ğ¸Ğ´ - ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

## ğŸ“‹ Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ

1. [ĞĞ±Ñ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°](#Ğ¾Ğ±Ñ‰Ğ°Ñ-Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)
2. [Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞºĞ¾Ğ´Ğ°](#ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°-ĞºĞ¾Ğ´Ğ°)
3. [ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²](#Ğ¿Ğ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾Ğµ-Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ-ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²)
4. [ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…](#Ğ¿Ğ¾Ñ‚Ğ¾Ğº-Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
5. [API Endpoints](#api-endpoints)
6. [Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…](#Ğ±Ğ°Ğ·Ğ°-Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
7. [ĞšĞ°Ğº Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ](#ĞºĞ°Ğº-Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ)
8. [ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ](#Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹-Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)
9. [Troubleshooting](#troubleshooting)

---

## ğŸ— ĞĞ±Ñ‰Ğ°Ñ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ĞšĞ›Ğ˜Ğ•ĞĞ¢ (Frontend/API)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚ HTTP Requests
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GIN WEB SERVER (:8080)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              API HANDLERS (route_handler.go)              â”‚ â”‚
â”‚  â”‚  - GenerateRoute()  - GetRoute()  - GetPOIs()             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                â”‚                â”‚
       â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POI Service  â”‚ â”‚  GIS Service â”‚ â”‚Content Serviceâ”‚
â”‚              â”‚ â”‚              â”‚ â”‚               â”‚
â”‚ - FindNearby â”‚ â”‚ - FindPlaces â”‚ â”‚ - GenerateTextâ”‚
â”‚ - GetByID    â”‚ â”‚ - BuildRoute â”‚ â”‚ - YandexGPT   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚                  â”‚
       â”‚                â”‚                  â”‚
       â–¼                â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL  â”‚ â”‚  2GIS API    â”‚ â”‚ Yandex APIs  â”‚
â”‚   Database   â”‚ â”‚              â”‚ â”‚  - GPT       â”‚
â”‚              â”‚ â”‚              â”‚ â”‚  - TTS       â”‚
â”‚  - pois      â”‚ â”‚              â”‚ â”‚  - Search    â”‚
â”‚  - routes    â”‚ â”‚              â”‚ â”‚              â”‚
â”‚  - waypoints â”‚ â”‚              â”‚ â”‚              â”‚
â”‚  - contents  â”‚ â”‚              â”‚ â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞšĞ¾Ğ´Ğ°

```
backend/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go              # ğŸš€ Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
â”‚
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ api/                     # ğŸŒ HTTP Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸
â”‚   â”‚   â”œâ”€â”€ routes.go            # Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… endpoints
â”‚   â”‚   â””â”€â”€ route_handler.go    # Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                  # ğŸ“Š ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
â”‚   â”‚   â””â”€â”€ models.go            # POI, Route, Waypoint, Content
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                # ğŸ”§ Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
â”‚   â”‚   â”œâ”€â”€ poi_service.go       # Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ¼ĞµÑÑ‚Ğ°Ğ¼Ğ¸ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ°
â”‚   â”‚   â”œâ”€â”€ gis_service.go       # Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ 2GIS
â”‚   â”‚   â”œâ”€â”€ content_service.go   # Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ° (YandexGPT)
â”‚   â”‚   â””â”€â”€ tts_service.go       # Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ°ÑƒĞ´Ğ¸Ğ¾ (Yandex TTS)
â”‚   â”‚
â”‚   â””â”€â”€ database/                # ğŸ’¾ Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ‘Ğ”
â”‚       â””â”€â”€ postgres.go          # ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.yaml              # âš™ï¸ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
â”‚
â”œâ”€â”€ audio/                       # ğŸ”Š Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ°ÑƒĞ´Ğ¸Ğ¾Ñ„Ğ°Ğ¹Ğ»Ñ‹
â”œâ”€â”€ keys/                        # ğŸ”‘ API ĞºĞ»ÑÑ‡Ğ¸
â”‚   â””â”€â”€ 2gis.key
â”‚
â”œâ”€â”€ go.mod                       # ğŸ“¦ Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Go
â””â”€â”€ .env                         # ğŸ” ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
```

---

## ğŸ” ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾Ğµ ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²

### 1. `cmd/server/main.go` - Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚:**
- Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ğ¸Ğ· `.env`
- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ Ğº PostgreSQL
- Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ‘Ğ”
- Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ GIN Ğ²ĞµĞ±-ÑĞµÑ€Ğ²ĞµÑ€ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 8080
- Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ²ÑĞµ API endpoints

**ĞšĞ¾Ğ´:**
```go
func main() {
    // 1. Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° .env
    godotenv.Load()
    
    // 2. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ‘Ğ”
    db, err := database.Connect()
    
    // 3. ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ (ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†)
    database.Migrate(db)
    
    // 4. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ğ°
    router := gin.Default()
    
    // 5. Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ endpoints
    api.RegisterRoutes(router, db)
    
    // 6. Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞµÑ€Ğ²ĞµÑ€Ğ°
    router.Run(":8080")
}
```

**ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ:**
1. Ğ§Ğ¸Ñ‚Ğ°ĞµÑ‚ `DATABASE_URL` Ğ¸Ğ· env
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ connection pool Ğº PostgreSQL
3. Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ ĞµÑĞ»Ğ¸ Ğ¸Ñ… Ğ½ĞµÑ‚
4. Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ²ÑĞµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
5. Ğ¡Ğ»ÑƒÑˆĞ°ĞµÑ‚ HTTP Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ½Ğ° `:8080`

---

### 2. `internal/models/models.go` - ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

#### **POI (Point of Interest) - ĞœĞµÑÑ‚Ğ¾ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ°**

```go
type POI struct {
    ID          uuid.UUID      // Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ID
    Name        string         // ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ (Ğ’Ğ”ĞĞ¥, ĞšÑ€ĞµĞ¼Ğ»ÑŒ)
    Description string         // ĞšÑ€Ğ°Ñ‚ĞºĞ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
    Latitude    float64        // Ğ¨Ğ¸Ñ€Ğ¾Ñ‚Ğ° (55.7558)
    Longitude   float64        // Ğ”Ğ¾Ğ»Ğ³Ğ¾Ñ‚Ğ° (37.6173)
    Epoch       string         // Ğ­Ğ¿Ğ¾Ñ…Ğ°: medieval, imperial, soviet, modern
    Category    string         // ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ: architecture, history, art
    Importance  int            // Ğ’Ğ°Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ 1-10
    YearBuilt   int            // Ğ“Ğ¾Ğ´ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
    Architect   string         // ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚Ğ¾Ñ€
    Style       string         // Ğ¡Ñ‚Ğ¸Ğ»ÑŒ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹
    Photos      pq.StringArray // ĞœĞ°ÑÑĞ¸Ğ² URL Ñ„Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ğ¹
    CreatedAt   time.Time      // ĞšĞ¾Ğ³Ğ´Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½
    UpdatedAt   time.Time      // ĞšĞ¾Ğ³Ğ´Ğ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½
}
```

**Ğ“Ğ´Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑÑ:** Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `pois` Ğ² PostgreSQL  
**ĞšĞ°Ğº ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ÑÑ:** Ğ§ĞµÑ€ĞµĞ· SQL ÑĞºÑ€Ğ¸Ğ¿Ñ‚ `scripts/import_sample_pois.py`  
**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```json
{
  "id": "179fd8c2-37cb-4c7d-8d7b-7fe0fd564d7f",
  "name": "Ğ’Ğ”ĞĞ¥",
  "latitude": 55.8304,
  "longitude": 37.6325,
  "epoch": "soviet",
  "category": "architecture",
  "importance": 10
}
```

---

#### **Route - ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚**

```go
type Route struct {
    ID                uuid.UUID      // ID Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°
    Name              string         // "Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ĞœĞ¾ÑĞºĞ²Ğ°: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°"
    Description       string         // ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°
    TotalDistance     float64        // ĞĞ±Ñ‰Ğ°Ñ Ğ´Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ Ğ² Ğ¼ĞµÑ‚Ñ€Ğ°Ñ…
    EstimatedDuration int            // Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ² Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°Ñ…
    Waypoints         []Waypoint     // Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚Ğ¾Ñ‡ĞµĞº Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°
    Epochs            pq.StringArray // ["soviet", "medieval"]
    Categories        pq.StringArray // ["architecture", "history"]
    CreatedAt         time.Time      // ĞšĞ¾Ğ³Ğ´Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½
}
```

**Ğ“Ğ´Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑÑ:** Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `routes`  
**ĞšĞ°Ğº ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ÑÑ:** Ğ§ĞµÑ€ĞµĞ· POST `/api/routes/generate`  
**Ğ¡Ğ²ÑĞ·Ğ¸:** Ğ˜Ğ¼ĞµĞµÑ‚ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Waypoints (Ğ¾Ğ´Ğ½Ğ° Ñ‚Ğ¾Ñ‡ĞºĞ° Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ° = Ğ¾Ğ´Ğ¸Ğ½ waypoint)

---

#### **Waypoint - Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ½Ğ° Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğµ**

```go
type Waypoint struct {
    ID        uuid.UUID  // ID waypoint
    RouteID   uuid.UUID  // Ğš ĞºĞ°ĞºĞ¾Ğ¼Ñƒ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ñƒ Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ÑÑ
    POIID     uuid.UUID  // ID Ğ¼ĞµÑÑ‚Ğ° Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ°
    POI       POI        // ĞŸĞ¾Ğ»Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¼ĞµÑÑ‚Ğ°
    Order     int        // ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº (1, 2, 3...)
    Content   *Content   // ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ (Ñ‚ĞµĞºÑÑ‚ + Ğ°ÑƒĞ´Ğ¸Ğ¾)
    CreatedAt time.Time
}
```

**Ğ“Ğ´Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑÑ:** Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `waypoints`  
**Ğ¡Ğ²ÑĞ·Ğ¸:**
- `RouteID` â†’ `routes.id` (Ğ¿Ñ€Ğ¸Ğ½Ğ°Ğ´Ğ»ĞµĞ¶Ğ¸Ñ‚ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ñƒ)
- `POIID` â†’ `pois.id` (ÑÑÑ‹Ğ»Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° Ğ¼ĞµÑÑ‚Ğ¾)
- `Content` â†’ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ¾

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ÑĞ²ÑĞ·Ğ¸:**
```
Route "Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ĞœĞ¾ÑĞºĞ²Ğ°"
  â”œâ”€ Waypoint #1 â†’ POI "Ğ’Ğ”ĞĞ¥" â†’ Content (Ñ‚ĞµĞºÑÑ‚ + audio.mp3)
  â”œâ”€ Waypoint #2 â†’ POI "ĞœĞ“Ğ£" â†’ Content (Ñ‚ĞµĞºÑÑ‚ + audio.mp3)
  â””â”€ Waypoint #3 â†’ POI "ĞÑÑ‚Ğ°Ğ½ĞºĞ¸Ğ½ÑĞºĞ°Ñ Ğ±Ğ°ÑˆĞ½Ñ" â†’ Content (Ñ‚ĞµĞºÑÑ‚ + audio.mp3)
```

---

#### **Content - ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ñ‚Ğ¾Ñ‡ĞºĞ¸**

```go
type Content struct {
    ID         uuid.UUID      // ID ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°
    WaypointID uuid.UUID      // Ğš ĞºĞ°ĞºĞ¾Ğ¼Ñƒ waypoint Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ÑÑ
    Text       string         // Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ‚ĞµĞºÑÑ‚ (300-400 ÑĞ»Ğ¾Ğ²)
    AudioPath  string         // ĞŸÑƒÑ‚ÑŒ Ğº MP3 Ñ„Ğ°Ğ¹Ğ»Ñƒ
    AudioURL   string         // URL Ğ´Ğ»Ñ ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ (/api/audio/uuid)
    Duration   int            // Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ°ÑƒĞ´Ğ¸Ğ¾ Ğ² ÑĞµĞºÑƒĞ½Ğ´Ğ°Ñ…
    Photos     pq.StringArray // Ğ¤Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ğ¸
    Generated  bool           // true ĞµÑĞ»Ğ¸ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾
    CreatedAt  time.Time
}
```

**Ğ“Ğ´Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑÑ:** Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `contents`  
**ĞšĞ°Ğº ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ÑÑ:** ĞÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ¾ Ğ¿Ğ¾ÑĞ»Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ waypoint  
**ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸:**
1. YandexGPT Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚ĞµĞºÑÑ‚ (2-3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ)
2. Yandex TTS ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ MP3 Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ°
3. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ² `./audio/waypoint-id.mp3`
4. Ğ—Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ² Ğ‘Ğ”

---

### 3. `internal/services/` - Ğ¡ĞµÑ€Ğ²Ğ¸ÑÑ‹ (Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°)

#### **POIService** - Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ¼ĞµÑÑ‚Ğ°Ğ¼Ğ¸ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ°

**Ğ¤Ğ°Ğ¹Ğ»:** `poi_service.go`

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹:**

##### `FindNearby()` - ĞŸĞ¾Ğ¸ÑĞº Ğ¼ĞµÑÑ‚ Ñ€ÑĞ´Ğ¾Ğ¼ Ñ Ñ‚Ğ¾Ñ‡ĞºĞ¾Ğ¹

```go
func (s *POIService) FindNearby(
    lat, lon float64,        // ĞšĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¸
    radiusMeters float64,    // Ğ Ğ°Ğ´Ğ¸ÑƒÑ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ² Ğ¼ĞµÑ‚Ñ€Ğ°Ñ…
    epochs []string,         // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ÑĞ¿Ğ¾Ñ…Ğ°Ğ¼
    categories []string,     // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼
) ([]models.POI, error)
```

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚:**
1. Ğ—Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµÑ‚ Ğ²ÑĞµ POI Ğ¸Ğ· Ğ‘Ğ” Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ğ¼Ğ¸ Ğ¿Ğ¾ ÑĞ¿Ğ¾Ñ…Ğµ Ğ¸ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸
2. Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¾Ñ‚ Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ´Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ POI (Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Haversine)
3. ĞÑ‚Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾ Ğ² Ñ€Ğ°Ğ´Ğ¸ÑƒÑĞµ
4. Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾ Ğ²Ğ°Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸ (importance)
5. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº

**Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ (Haversine):**
```go
func calculateDistance(lat1, lon1, lat2, lon2 float64) float64 {
    const earthRadius = 6371000.0 // Ğ¼ĞµÑ‚Ñ€Ñ‹
    
    // ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ² Ñ€Ğ°Ğ´Ğ¸Ğ°Ğ½Ñ‹
    lat1Rad := lat1 * math.Pi / 180
    lat2Rad := lat2 * math.Pi / 180
    deltaLat := (lat2 - lat1) * math.Pi / 180
    deltaLon := (lon2 - lon1) * math.Pi / 180
    
    // Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Haversine
    a := sinÂ²(Î”lat/2) + cos(lat1) Ã— cos(lat2) Ã— sinÂ²(Î”lon/2)
    c := 2 Ã— atan2(âˆša, âˆš(1âˆ’a))
    
    return earthRadius Ã— c  // Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ² Ğ¼ĞµÑ‚Ñ€Ğ°Ñ…
}
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```go
// ĞŸĞ¾Ğ¸ÑĞº ÑĞ¾Ğ²ĞµÑ‚ÑĞºĞ¸Ñ… Ğ¿Ğ°Ğ¼ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ² Ğ² Ñ€Ğ°Ğ´Ğ¸ÑƒÑĞµ 5ĞºĞ¼ Ğ¾Ñ‚ ĞšÑ€Ğ°ÑĞ½Ğ¾Ğ¹ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´Ğ¸
pois, _ := poiService.FindNearby(
    55.7539, 37.6208,     // ĞšÑ€Ğ°ÑĞ½Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ
    5000,                  // 5 ĞºĞ¼
    []string{"soviet"},    // Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ÑĞ¿Ğ¾Ñ…Ğ°
    []string{"architecture"}, // ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°
)
// Ğ’ĞµÑ€Ğ½ĞµÑ‚: [Ğ’Ğ”ĞĞ¥, ĞœĞ“Ğ£, ĞÑÑ‚Ğ°Ğ½ĞºĞ¸Ğ½Ğ¾, ...]
```

---

#### **GISService** - Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ 2GIS API

**Ğ¤Ğ°Ğ¹Ğ»:** `gis_service.go`

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹:**

##### `FindPlacesNearby()` - ĞŸĞ¾Ğ¸ÑĞº Ğ¼ĞµÑÑ‚ Ñ‡ĞµÑ€ĞµĞ· 2GIS

```go
func (s *GISService) FindPlacesNearby(
    lat, lon, radius float64,
    query string,           // ĞŸĞ¾Ğ¸ÑĞºĞ¾Ğ²Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
) ([]Place, error)
```

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚:**
1. Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğº 2GIS Catalog API
2. Ğ˜Ñ‰ĞµÑ‚ Ğ¼ĞµÑÑ‚Ğ° Ğ¿Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑƒ Ğ² Ñ€Ğ°Ğ´Ğ¸ÑƒÑĞµ
3. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¼ĞµÑÑ‚ Ñ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ğ°Ğ¼Ğ¸

**API Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ:**
```
GET https://catalog.api.2gis.com/3.0/items
  ?key={API_KEY}
  &point={lon},{lat}
  &radius={radius}
  &q={query}
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```go
places, _ := gisService.FindPlacesNearby(
    55.7558, 37.6173,
    2000,
    "Ğ¼ÑƒĞ·ĞµĞ¹",
)
// Ğ’ĞµÑ€Ğ½ĞµÑ‚ Ğ¼ĞµÑÑ‚Ğ° Ğ¸Ğ· 2GIS API
```

##### `BuildRoute()` - ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°

```go
func (s *GISService) BuildRoute(
    points []RoutePoint,    // Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚Ğ¾Ñ‡ĞµĞº
    routeType string,       // "pedestrian" Ğ¸Ğ»Ğ¸ "car"
) (*RouteResult, error)
```

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚:**
1. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ² 2GIS Routing API
2. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚
3. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ, Ğ²Ñ€ĞµĞ¼Ñ, Ğ³ĞµĞ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ

**API Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ:**
```
GET https://catalog.api.2gis.com/routing/7.0.0/global
  ?key={API_KEY}
  &type=pedestrian
  &points={lon1},{lat1};{lon2},{lat2};...
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
{
  "total_distance": 4500,  // Ğ¼ĞµÑ‚Ñ€Ñ‹
  "total_duration": 3600,  // ÑĞµĞºÑƒĞ½Ğ´Ñ‹
  "geometry": [[37.6173, 55.7558], [37.6325, 55.8304], ...]
}
```

---

#### **ContentService** - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°

**Ğ¤Ğ°Ğ¹Ğ»:** `content_service.go`

##### `GenerateDescription()` - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ°

```go
func (s *ContentService) GenerateDescription(
    poi models.POI,
) (string, error)
```

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚:**

**Ğ¨Ğ°Ğ³ 1:** ĞŸĞ¾Ğ¸ÑĞº Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
```go
if s.searchUser != "" {
    // Ğ˜Ñ‰ĞµĞ¼ Ñ‡ĞµÑ€ĞµĞ· Yandex Search API
    additionalInfo := searchForPOI(poi)
}
```

**Ğ¨Ğ°Ğ³ 2:** Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ° Ğ´Ğ»Ñ YandexGPT
```go
prompt := fmt.Sprintf(`
Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ÑƒĞ²Ğ»ĞµĞºĞ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°ÑÑĞºĞ°Ğ· Ğ´Ğ»Ñ Ğ°ÑƒĞ´Ğ¸Ğ¾Ğ³Ğ¸Ğ´Ğ° Ğ¾ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¼ Ğ¼ĞµÑÑ‚Ğµ:

ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ: %s
ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ: %s
Ğ­Ğ¿Ğ¾Ñ…Ğ°: %s
Ğ“Ğ¾Ğ´ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸: %d
ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚Ğ¾Ñ€: %s

Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
- Ğ”Ğ»Ğ¸Ğ½Ğ°: 2-3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ (300-400 ÑĞ»Ğ¾Ğ²)
- Ğ¡Ñ‚Ğ¸Ğ»ÑŒ: Ğ¶Ğ¸Ğ²Ğ¾Ğ¹, ÑƒĞ²Ğ»ĞµĞºĞ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹
- Ğ’ĞºĞ»ÑÑ‡Ğ¸ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ñ‹Ğµ Ñ„Ğ°ĞºÑ‚Ñ‹
- ĞĞ±Ñ€Ğ°Ñ‰Ğ°Ğ¹ÑÑ Ğ½Ğ° "Ğ²Ñ‹"
`, poi.Name, poi.Description, poi.Epoch, poi.YearBuilt, poi.Architect)
```

**Ğ¨Ğ°Ğ³ 3:** Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğº YandexGPT
```json
POST https://llm.api.cloud.yandex.net/foundationModels/v1/completion
{
  "modelUri": "gpt://folder_id/yandexgpt/latest",
  "messages": [
    {"role": "system", "text": "Ğ¢Ñ‹ Ğ¿Ñ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑĞºÑĞºÑƒÑ€ÑĞ¾Ğ²Ğ¾Ğ´..."},
    {"role": "user", "text": "{prompt}"}
  ],
  "completionOptions": {
    "temperature": 0.7,
    "maxTokens": "1000"
  }
}
```

**Ğ¨Ğ°Ğ³ 4:** ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°
```json
{
  "result": {
    "alternatives": [{
      "message": {
        "text": "ĞŸĞµÑ€ĞµĞ´ Ğ²Ğ°Ğ¼Ğ¸ Ğ·Ğ½Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚Ğ°Ñ Ğ’Ğ”ĞĞ¥ - Ğ³Ñ€Ğ°Ğ½Ğ´Ğ¸Ğ¾Ğ·Ğ½Ñ‹Ğ¹ Ğ²Ñ‹ÑÑ‚Ğ°Ğ²Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑ..."
      }
    }]
  }
}
```

**Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚:** Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ‚ĞµĞºÑÑ‚ (300-400 ÑĞ»Ğ¾Ğ²)

---

#### **TTSService** - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ°ÑƒĞ´Ğ¸Ğ¾

**Ğ¤Ğ°Ğ¹Ğ»:** `tts_service.go`

##### `GenerateAudio()` - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ MP3

```go
func (s *TTSService) GenerateAudio(
    text string,      // Ğ¢ĞµĞºÑÑ‚ Ğ´Ğ»Ñ Ğ¾Ğ·Ğ²ÑƒÑ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ
    filename string,  // waypoint-id
) (audioPath string, duration int, error)
```

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚:**

**Ğ¨Ğ°Ğ³ 1:** Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğº Yandex SpeechKit
```
POST https://tts.api.cloud.yandex.net/speech/v1/tts:synthesize
  ?text={text}
  &lang=ru-RU
  &voice=alena
  &speed=1.0
  &format=mp3
  &folderId={folder_id}

Headers:
  Authorization: Api-Key {api_key}
```

**Ğ¨Ğ°Ğ³ 2:** ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ°ÑƒĞ´Ğ¸Ğ¾ (Ğ±Ğ¸Ğ½Ğ°Ñ€Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ MP3)

**Ğ¨Ğ°Ğ³ 3:** Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ñ„Ğ°Ğ¹Ğ»
```go
audioPath := "./audio/waypoint-uuid.mp3"
file.Write(audioData)
```

**Ğ¨Ğ°Ğ³ 4:** Ğ Ğ°ÑÑ‡ĞµÑ‚ Ğ´Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
```go
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ğ½Ğ¾ 150 ÑĞ»Ğ¾Ğ² Ğ² Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñƒ
words := len(text) / 5
durationSeconds := (words * 60) / 150
```

**Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚:**
- `audioPath`: "./audio/123e4567-e89b-12d3-a456-426614174000.mp3"
- `duration`: 180 (ÑĞµĞºÑƒĞ½Ğ´)

**Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ Ğ³Ğ¾Ğ»Ğ¾ÑĞ°:**
- `alena` - Ğ¼ÑĞ³ĞºĞ¸Ğ¹ Ğ¶ĞµĞ½ÑĞºĞ¸Ğ¹ (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
- `filipp` - Ğ½ĞµĞ¹Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼ÑƒĞ¶ÑĞºĞ¾Ğ¹
- `jane` - ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¶ĞµĞ½ÑĞºĞ¸Ğ¹
- `ermil` - ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼ÑƒĞ¶ÑĞºĞ¾Ğ¹

---

### 4. `internal/api/route_handler.go` - HTTP Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸

#### `GenerateRoute()` - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°

**Endpoint:** `POST /api/routes/generate`

**Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:**
```json
{
  "start_point": {
    "lat": 55.7558,
    "lon": 37.6173
  },
  "duration_minutes": 60,
  "epochs": ["soviet", "medieval"],
  "interests": ["architecture", "history"],
  "max_waypoints": 5
}
```

**ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°                            â”‚
â”‚    - ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ JSON                               â”‚
â”‚    - Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Ğ Ğ°ÑÑ‡ĞµÑ‚ Ñ€Ğ°Ğ´Ğ¸ÑƒÑĞ° Ğ¿Ğ¾Ğ¸ÑĞºĞ°                        â”‚
â”‚    radius = duration_minutes Ã— 83 Ğ¼/Ğ¼Ğ¸Ğ½         â”‚
â”‚    (ÑÑ€ĞµĞ´Ğ½ÑÑ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ Ğ¿ĞµÑˆĞµÑ…Ğ¾Ğ´Ğ°)                  â”‚
â”‚    ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: 60 Ğ¼Ğ¸Ğ½ Ã— 83 = 4980 Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ĞŸĞ¾Ğ¸ÑĞº POI                                    â”‚
â”‚    poiService.FindNearby(                       â”‚
â”‚      lat, lon, radius,                          â”‚
â”‚      epochs, interests                          â”‚
â”‚    )                                            â”‚
â”‚    â†“                                            â”‚
â”‚    Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚: [POI1, POI2, POI3, ...]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ°                          â”‚
â”‚    if len(pois) == 0:                           â”‚
â”‚      return error "No POIs found"               â”‚
â”‚                                                 â”‚
â”‚    if len(pois) > max_waypoints:                â”‚
â”‚      pois = pois[:max_waypoints]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ° Ğ² Ğ‘Ğ”                       â”‚
â”‚    route = Route{                               â”‚
â”‚      Name: "Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ĞœĞ¾ÑĞºĞ²Ğ°: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°",     â”‚
â”‚      EstimatedDuration: 60,                     â”‚
â”‚      Epochs: ["soviet"],                        â”‚
â”‚      Categories: ["architecture"]               â”‚
â”‚    }                                            â”‚
â”‚    db.Create(&route)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ waypoints                           â”‚
â”‚    for i, poi := range pois {                   â”‚
â”‚      waypoint = Waypoint{                       â”‚
â”‚        RouteID: route.ID,                       â”‚
â”‚        POIID: poi.ID,                           â”‚
â”‚        Order: i + 1                             â”‚
â”‚      }                                          â”‚
â”‚      waypoints = append(waypoints, waypoint)    â”‚
â”‚    }                                            â”‚
â”‚    db.Create(&waypoints)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° (Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ¾)      â”‚
â”‚    go generateContentForWaypoints(waypoints)    â”‚
â”‚    â†“                                            â”‚
â”‚    Ğ’ Ñ„Ğ¾Ğ½Ğµ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ waypoint:                 â”‚
â”‚    - Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚ĞµĞºÑÑ‚ Ñ‡ĞµÑ€ĞµĞ· YandexGPT           â”‚
â”‚    - Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ°ÑƒĞ´Ğ¸Ğ¾ Ñ‡ĞµÑ€ĞµĞ· Yandex TTS             â”‚
â”‚    - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ² Ğ‘Ğ”                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°                          â”‚
â”‚    response = {                                 â”‚
â”‚      route_id: "uuid",                          â”‚
â”‚      name: "Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ĞœĞ¾ÑĞºĞ²Ğ°",                  â”‚
â”‚      waypoints: [...]                           â”‚
â”‚    }                                            â”‚
â”‚    return JSON                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ’Ñ‹Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:**
```json
{
  "route_id": "ea7a7092-8fa1-44c2-a656-55f38d4822e3",
  "name": "Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ĞœĞ¾ÑĞºĞ²Ğ°: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°",
  "total_distance": 0,
  "estimated_duration": 60,
  "waypoints": [
    {
      "id": "waypoint-uuid-1",
      "name": "Ğ’Ğ”ĞĞ¥",
      "description": "Ğ’Ñ‹ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¹...",
      "coordinates": {"lat": 55.8304, "lon": 37.6325},
      "epoch": "soviet",
      "category": "architecture",
      "order": 1,
      "content": null  // Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ¾
    }
  ]
}
```

---

#### `GetRoute()` - ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°

**Endpoint:** `GET /api/routes/:route_id`

**ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼:**
1. ĞŸĞ°Ñ€ÑĞ¸Ñ‚ `route_id` Ğ¸Ğ· URL
2. Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚ Ğ¸Ğ· Ğ‘Ğ” Ñ Preload:
   ```go
   db.Preload("Waypoints.POI").
      Preload("Waypoints.Content").
      First(&route, "id = ?", uid)
   ```
3. Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚ Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼
4. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ JSON

**ĞÑ‚Ğ²ĞµÑ‚ (Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼):**
```json
{
  "route_id": "ea7a7092-...",
  "waypoints": [
    {
      "id": "waypoint-1",
      "name": "Ğ’Ğ”ĞĞ¥",
      "content": {
        "text": "ĞŸĞµÑ€ĞµĞ´ Ğ²Ğ°Ğ¼Ğ¸ Ğ·Ğ½Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚Ğ°Ñ Ğ’Ğ”ĞĞ¥...",
        "audio_url": "/api/audio/waypoint-1",
        "duration_seconds": 180,
        "photos": ["url1", "url2"]
      }
    }
  ]
}
```

---

## ğŸ”„ ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹: ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚

```
ĞšĞ›Ğ˜Ğ•ĞĞ¢                 API HANDLER           SERVICES              Ğ‘ĞĞ—Ğ Ğ”ĞĞĞĞ«Ğ¥        Ğ’ĞĞ•Ğ¨ĞĞ˜Ğ• API
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚ POST /routes/generate   â”‚                    â”‚                      â”‚                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚ FindNearby()       â”‚                      â”‚                  â”‚
  â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚  SELECT * FROM pois  â”‚                  â”‚
  â”‚                         â”‚                    â”‚  WHERE epoch IN (...)â”‚                  â”‚
  â”‚                         â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚                         â”‚                    â”‚   [POI1, POI2, ...]  â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚ [filtered POIs]    â”‚                      â”‚                  â”‚
  â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚  INSERT route      â”‚                      â”‚                  â”‚
  â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚  INSERT waypoints  â”‚                      â”‚                  â”‚
  â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚  {route_id, waypoints}  â”‚                    â”‚                      â”‚                  â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚ go generateContent()                      â”‚                  â”‚
  â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚ GenerateDescription()                   â”‚
  â”‚                         â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                         â”‚                    â”‚                      â”‚   YandexGPT API  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                         â”‚                    â”‚        {text}        â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚ GenerateAudio()      â”‚                  â”‚
  â”‚                         â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                         â”‚                    â”‚                      â”‚   Yandex TTS     â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                         â”‚                    â”‚      {audio.mp3}     â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚  INSERT content      â”‚                  â”‚
  â”‚                         â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚ GET /routes/{id}        â”‚                    â”‚                      â”‚                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚  SELECT route      â”‚                      â”‚                  â”‚
  â”‚                         â”‚  WITH waypoints    â”‚                      â”‚                  â”‚
  â”‚                         â”‚  AND content       â”‚                      â”‚                  â”‚
  â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚  {route + content}      â”‚   [full data]      â”‚                      â”‚                  â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚ GET /audio/{waypoint}   â”‚                    â”‚                      â”‚                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚  SELECT content    â”‚                      â”‚                  â”‚
  â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                         â”‚                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚  audio.mp3 (binary)     â”‚   {audio_path}     â”‚                      â”‚                  â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                      â”‚                  â”‚
  â”‚                         â”‚  Read file & send  â”‚                      â”‚                  â”‚
```

---

## ğŸ“¡ API Endpoints - ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

### 1. Health Check

**Endpoint:** `GET /api/health`

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ¾ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚Ğ¸ ÑĞµÑ€Ğ²ĞµÑ€Ğ°

**Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ:**
```bash
curl http://localhost:8080/api/health
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
{
  "status": "ok",
  "message": "Audioguid API is running"
}
```

---

### 2. Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¼ĞµÑÑ‚ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ°

**Endpoint:** `GET /api/pois`

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ²ÑĞµÑ… POI Ğ¸Ğ»Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ

**Query Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:**
- `epoch` - Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ÑĞ¿Ğ¾Ñ…Ğµ (`medieval`, `imperial`, `soviet`, `modern`)
- `category` - Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ (`architecture`, `history`, `art`, `culture`, `religion`)

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹:**

```bash
# Ğ’ÑĞµ POI
curl http://localhost:8080/api/pois

# Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°
curl "http://localhost:8080/api/pois?epoch=soviet&category=architecture"

# Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞ²ĞµĞºĞ¾Ğ²Ğ°Ñ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ
curl "http://localhost:8080/api/pois?epoch=medieval&category=history"
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
[
  {
    "ID": "179fd8c2-37cb-4c7d-8d7b-7fe0fd564d7f",
    "Name": "Ğ’Ğ”ĞĞ¥",
    "Description": "Ğ’Ñ‹ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ñ…Ğ¾Ğ·ÑĞ¹ÑÑ‚Ğ²Ğ° Ğ¡Ğ¡Ğ¡Ğ ",
    "Latitude": 55.8304,
    "Longitude": 37.6325,
    "Epoch": "soviet",
    "Category": "architecture",
    "Importance": 10,
    "YearBuilt": 1939,
    "Architect": "Ğ’ÑÑ‡ĞµÑĞ»Ğ°Ğ² ĞĞ»Ñ‚Ğ°Ñ€Ğ¶ĞµĞ²ÑĞºĞ¸Ğ¹",
    "Style": "Ğ¡Ñ‚Ğ°Ğ»Ğ¸Ğ½ÑĞºĞ¸Ğ¹ Ğ°Ğ¼Ğ¿Ğ¸Ñ€",
    "Photos": ["url1", "url2"]
  }
]
```

---

### 3. Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑÑ‚Ğ°

**Endpoint:** `GET /api/pois/:poi_id`

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¾ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¼ Ğ¼ĞµÑÑ‚Ğµ

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```bash
curl http://localhost:8080/api/pois/179fd8c2-37cb-4c7d-8d7b-7fe0fd564d7f
```

**ĞÑ‚Ğ²ĞµÑ‚:** ĞĞ´Ğ¸Ğ½ Ğ¾Ğ±ÑŠĞµĞºÑ‚ POI

---

### 4. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°

**Endpoint:** `POST /api/routes/generate`

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ° Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ¿Ñ€ĞµĞ´Ğ¿Ğ¾Ñ‡Ñ‚ĞµĞ½Ğ¸Ğ¹

**Content-Type:** `application/json`

**Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°:**
```json
{
  "start_point": {
    "lat": 55.7558,    // Ğ¨Ğ¸Ñ€Ğ¾Ñ‚Ğ° Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¸
    "lon": 37.6173     // Ğ”Ğ¾Ğ»Ğ³Ğ¾Ñ‚Ğ° Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¸
  },
  "duration_minutes": 60,  // Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³ÑƒĞ»ĞºĞ¸ (15-180)
  "epochs": [              // Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ÑĞ¿Ğ¾Ñ…Ğ¸ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
    "soviet",
    "medieval"
  ],
  "interests": [           // Ğ˜Ğ½Ñ‚ĞµÑ€ĞµÑÑ‹ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
    "architecture",
    "history"
  ],
  "max_waypoints": 5       // ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ñ‚Ğ¾Ñ‡ĞµĞº (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾, Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 5)
}
```

**ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:**

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | Ğ¢Ğ¸Ğ¿ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|----------|-----|--------------|----------|
| start_point.lat | float | âœ… | Ğ¨Ğ¸Ñ€Ğ¾Ñ‚Ğ° (55.0 - 56.0 Ğ´Ğ»Ñ ĞœĞ¾ÑĞºĞ²Ñ‹) |
| start_point.lon | float | âœ… | Ğ”Ğ¾Ğ»Ğ³Ğ¾Ñ‚Ğ° (37.0 - 38.0 Ğ´Ğ»Ñ ĞœĞ¾ÑĞºĞ²Ñ‹) |
| duration_minutes | int | âœ… | 15-180 Ğ¼Ğ¸Ğ½ÑƒÑ‚ |
| epochs | []string | âŒ | medieval, imperial, soviet, modern |
| interests | []string | âŒ | architecture, history, culture, religion, art |
| max_waypoints | int | âŒ | 1-10, Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 5 |

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²:**

**Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° (60 Ğ¼Ğ¸Ğ½ÑƒÑ‚):**
```bash
curl -X POST http://localhost:8080/api/routes/generate \
  -H "Content-Type: application/json" \
  -d '{
    "start_point": {"lat": 55.7558, "lon": 37.6173},
    "duration_minutes": 60,
    "epochs": ["soviet"],
    "interests": ["architecture"]
  }'
```

**Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞ²ĞµĞºĞ¾Ğ²Ğ°Ñ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ (45 Ğ¼Ğ¸Ğ½ÑƒÑ‚):**
```bash
curl -X POST http://localhost:8080/api/routes/generate \
  -H "Content-Type: application/json" \
  -d '{
    "start_point": {"lat": 55.7539, "lon": 37.6208},
    "duration_minutes": 45,
    "epochs": ["medieval"],
    "interests": ["history", "religion"]
  }'
```

**Ğ¡Ğ¼ĞµÑˆĞ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚ (120 Ğ¼Ğ¸Ğ½ÑƒÑ‚):**
```bash
curl -X POST http://localhost:8080/api/routes/generate \
  -H "Content-Type: application/json" \
  -d '{
    "start_point": {"lat": 55.7558, "lon": 37.6173},
    "duration_minutes": 120,
    "epochs": ["soviet", "medieval", "imperial"],
    "interests": ["architecture", "history", "art"],
    "max_waypoints": 8
  }'
```

**ĞÑ‚Ğ²ĞµÑ‚ (ÑÑ€Ğ°Ğ·Ñƒ Ğ¿Ğ¾ÑĞ»Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ):**
```json
{
  "route_id": "ea7a7092-8fa1-44c2-a656-55f38d4822e3",
  "name": "Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ĞœĞ¾ÑĞºĞ²Ğ°: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°",
  "total_distance": 0,
  "estimated_duration": 60,
  "waypoints": [
    {
      "id": "7e127c92-12bb-4119-94dc-72b75abd1180",
      "name": "ĞšÑ€Ğ°ÑĞ½Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ",
      "description": "Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ ĞœĞ¾ÑĞºĞ²Ñ‹",
      "coordinates": {
        "lat": 55.7539,
        "lon": 37.6208
      },
      "epoch": "medieval",
      "category": "history",
      "order": 1,
      "content": null  // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ¾!
    },
    {
      "id": "3a3546bb-e90a-4455-b039-e56f75908b86",
      "name": "ĞšÑ€ĞµĞ¼Ğ»ÑŒ",
      "description": "Ğ”Ñ€ĞµĞ²Ğ½ÑÑ ĞºÑ€ĞµĞ¿Ğ¾ÑÑ‚ÑŒ",
      "coordinates": {
        "lat": 55.752,
        "lon": 37.6175
      },
      "epoch": "medieval",
      "category": "history",
      "order": 2,
      "content": null
    }
  ]
}
```

**Ğ’Ğ°Ğ¶Ğ½Ğ¾:** `content` Ğ±ÑƒĞ´ĞµÑ‚ `null` ÑÑ€Ğ°Ğ·Ñƒ Ğ¿Ğ¾ÑĞ»Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ, Ñ‚Ğ°Ğº ĞºĞ°Ğº Ñ‚ĞµĞºÑÑ‚ Ğ¸ Ğ°ÑƒĞ´Ğ¸Ğ¾ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ¾ (1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹ Ğ½Ğ° Ñ‚Ğ¾Ñ‡ĞºÑƒ).

---

### 5. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ° Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼

**Endpoint:** `GET /api/routes/:route_id`

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ñ… Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ° (Ñ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼)

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```bash
# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ route_id Ğ¸Ğ· Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
curl http://localhost:8080/api/routes/ea7a7092-8fa1-44c2-a656-55f38d4822e3
```

**ĞÑ‚Ğ²ĞµÑ‚ (Ğ¿Ğ¾ÑĞ»Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°):**
```json
{
  "route_id": "ea7a7092-8fa1-44c2-a656-55f38d4822e3",
  "name": "Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ĞœĞ¾ÑĞºĞ²Ğ°: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°",
  "total_distance": 4500,
  "estimated_duration": 60,
  "waypoints": [
    {
      "id": "7e127c92-12bb-4119-94dc-72b75abd1180",
      "name": "ĞšÑ€Ğ°ÑĞ½Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ",
      "description": "Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ ĞœĞ¾ÑĞºĞ²Ñ‹",
      "coordinates": {
        "lat": 55.7539,
        "lon": 37.6208
      },
      "epoch": "medieval",
      "category": "history",
      "order": 1,
      "content": {
        "text": "ĞŸĞµÑ€ĞµĞ´ Ğ²Ğ°Ğ¼Ğ¸ Ñ€Ğ°ÑĞºĞ¸Ğ½ÑƒĞ»Ğ°ÑÑŒ Ğ»ĞµĞ³ĞµĞ½Ğ´Ğ°Ñ€Ğ½Ğ°Ñ ĞšÑ€Ğ°ÑĞ½Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ...",
        "audio_url": "/api/audio/7e127c92-12bb-4119-94dc-72b75abd1180",
        "duration_seconds": 180,
        "photos": ["url1", "url2"]
      }
    }
  ]
}
```

**Ğ•ÑĞ»Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ ĞµÑ‰Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ:**
```json
{
  "waypoints": [{
    "content": null  // ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ 1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹ Ğ¸ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
  }]
}
```

---

### 6. Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ°ÑƒĞ´Ğ¸Ğ¾

**Endpoint:** `GET /api/audio/:waypoint_id`

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ MP3 Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ´Ğ»Ñ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```bash
# Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ°ÑƒĞ´Ğ¸Ğ¾ Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¸
curl http://localhost:8080/api/audio/7e127c92-12bb-4119-94dc-72b75abd1180 \
  -o waypoint1.mp3

# Ğ’Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ¸ Ñ‡ĞµÑ€ĞµĞ· ffplay
ffplay waypoint1.mp3
```

**ĞÑ‚Ğ²ĞµÑ‚:** Binary MP3 file

**Headers:**
```
Content-Type: audio/mpeg
Content-Length: 245678
```

**ĞÑˆĞ¸Ğ±ĞºĞ¸:**
```json
// Ğ•ÑĞ»Ğ¸ Ğ°ÑƒĞ´Ğ¸Ğ¾ ĞµÑ‰Ğµ Ğ½Ğµ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾
{
  "error": "Audio not generated yet"
}

// Ğ•ÑĞ»Ğ¸ waypoint Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½
{
  "error": "Audio not found"
}
```

---

## ğŸ’¾ Ğ‘Ğ°Ğ·Ğ° Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ¡Ñ…ĞµĞ¼Ğ° PostgreSQL

```sql
-- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ¼ĞµÑÑ‚ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ°
CREATE TABLE pois (
    id            UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name          TEXT NOT NULL,
    description   TEXT,
    latitude      NUMERIC NOT NULL,
    longitude     NUMERIC NOT NULL,
    epoch         TEXT,              -- medieval, imperial, soviet, modern
    category      TEXT,              -- architecture, history, art, culture, religion
    importance    BIGINT DEFAULT 5,  -- 1-10
    year_built    BIGINT,
    architect     TEXT,
    style         TEXT,
    photos        TEXT[],            -- ĞœĞ°ÑÑĞ¸Ğ² URL
    wikipedia_url TEXT,
    metadata      JSONB,
    created_at    TIMESTAMP DEFAULT NOW(),
    updated_at    TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_pois_epoch ON pois(epoch);
CREATE INDEX idx_pois_category ON pois(category);

-- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¾Ğ²
CREATE TABLE routes (
    id                 UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name               TEXT,
    description        TEXT,
    total_distance     NUMERIC,        -- Ğ¼ĞµÑ‚Ñ€Ñ‹
    estimated_duration BIGINT,         -- Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹
    epochs             TEXT[],
    categories         TEXT[],
    created_at         TIMESTAMP DEFAULT NOW()
);

-- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ñ‚Ğ¾Ñ‡ĞµĞº Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ°
CREATE TABLE waypoints (
    id         UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    route_id   UUID NOT NULL REFERENCES routes(id) ON DELETE CASCADE,
    poi_id     UUID NOT NULL REFERENCES pois(id),
    "order"    BIGINT NOT NULL,        -- ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ñ‚Ğ¾Ñ‡ĞºĞ¸ (1, 2, 3...)
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_waypoints_route_id ON waypoints(route_id);

-- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°
CREATE TABLE contents (
    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    waypoint_id UUID NOT NULL UNIQUE REFERENCES waypoints(id) ON DELETE CASCADE,
    text        TEXT NOT NULL,
    audio_url   TEXT,
    audio_path  TEXT,
    duration    BIGINT,                -- ÑĞµĞºÑƒĞ½Ğ´Ñ‹
    photos      TEXT[],
    generated   BOOLEAN DEFAULT FALSE,
    created_at  TIMESTAMP DEFAULT NOW()
);

CREATE UNIQUE INDEX idx_contents_waypoint_id ON contents(waypoint_id);
```

### Ğ¡Ğ²ÑĞ·Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°Ğ¼Ğ¸

```
pois (12 Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹)
  â”œâ”€ Ğ’Ğ”ĞĞ¥
  â”œâ”€ ĞœĞ“Ğ£
  â”œâ”€ ĞÑÑ‚Ğ°Ğ½ĞºĞ¸Ğ½Ğ¾
  â””â”€ ...

routes
  â””â”€ "Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ ĞœĞ¾ÑĞºĞ²Ğ°"
      â”œâ”€ waypoints
      â”‚   â”œâ”€ waypoint_1 â†’ poi_id: Ğ’Ğ”ĞĞ¥ â†’ content_1
      â”‚   â”œâ”€ waypoint_2 â†’ poi_id: ĞœĞ“Ğ£ â†’ content_2
      â”‚   â””â”€ waypoint_3 â†’ poi_id: ĞÑÑ‚Ğ°Ğ½ĞºĞ¸Ğ½Ğ¾ â†’ content_3

contents
  â”œâ”€ content_1: text + audio Ğ´Ğ»Ñ Ğ’Ğ”ĞĞ¥
  â”œâ”€ content_2: text + audio Ğ´Ğ»Ñ ĞœĞ“Ğ£
  â””â”€ content_3: text + audio Ğ´Ğ»Ñ ĞÑÑ‚Ğ°Ğ½ĞºĞ¸Ğ½Ğ¾
```

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğº Ğ‘Ğ”

**Ğ’ÑĞµ ÑĞ¾Ğ²ĞµÑ‚ÑĞºĞ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ½Ğ¸ĞºĞ¸:**
```sql
SELECT name, latitude, longitude, year_built
FROM pois
WHERE epoch = 'soviet'
ORDER BY importance DESC;
```

**ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚ Ñ Ñ‚Ğ¾Ñ‡ĞºĞ°Ğ¼Ğ¸:**
```sql
SELECT
  r.name as route_name,
  w.order,
  p.name as poi_name,
  p.latitude,
  p.longitude
FROM routes r
JOIN waypoints w ON w.route_id = r.id
JOIN pois p ON p.id = w.poi_id
WHERE r.id = 'your-route-id'
ORDER BY w.order;
```

**Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ ÑĞ¿Ğ¾Ñ…Ğ°Ğ¼:**
```sql
SELECT epoch, COUNT(*) as count
FROM pois
GROUP BY epoch;
```

---

## ğŸš€ ĞšĞ°Ğº Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)

```bash
# 1. ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ² Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ backend
cd /Users/dimmy-kor/Projects/2gis_hackaton/backend

# 2. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½ÑƒÑ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
export DATABASE_URL="postgresql://nike:<password>@51.250.86.178:<port>/audioguid?sslmode=disable"

# 3. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞµÑ€Ğ²ĞµÑ€
go run cmd/server/main.go
```

**Ğ’Ñ‹Ğ²Ğ¾Ğ´:**
```
2025/10/05 00:42:16 ğŸš€ Server starting on port 8080
[GIN-debug] GET    /api/health
[GIN-debug] POST   /api/routes/generate
[GIN-debug] GET    /api/routes/:route_id
[GIN-debug] GET    /api/pois
[GIN-debug] GET    /api/pois/:poi_id
[GIN-debug] GET    /api/audio/:waypoint_id
[GIN-debug] Listening and serving HTTP on :8080
```

**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:**
```bash
curl http://localhost:8080/api/health
# {"status":"ok","message":"Audioguid API is running"}
```

---

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: Ğ¡ .env Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ¼

```bash
cd /Users/dimmy-kor/Projects/2gis_hackaton/backend

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ .env Ñ„Ğ°Ğ¹Ğ»
cat > .env << 'EOF'
# Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
DATABASE_URL=postgresql://nike:<password>@51.250.86.178:<port>/audioguid?sslmode=disable

# Yandex Cloud (Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°)
YANDEX_API_KEY=your_api_key_here
YANDEX_FOLDER_ID=your_folder_id_here
YANDEX_VOICE=alena

# 2GIS
GAPIS_API_KEY=1bfdf79c-0a09-4ea6-882e-afc09421c8d5
GAPIS_APP_ID=ru.2gishackathon.app06.02
GAPIS_KEY_FILE=./keys/2gis.key

# Server
PORT=8080
EOF

# Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ
go run cmd/server/main.go
```

---

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 3: ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ Ğ² Ğ±Ğ¸Ğ½Ğ°Ñ€Ğ½Ğ¸Ğº

```bash
cd /Users/dimmy-kor/Projects/2gis_hackaton/backend

# Ğ¡ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
go build -o audioguid cmd/server/main.go

# Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ
export DATABASE_URL="postgresql://nike:<password>@51.250.86.178:<port>/audioguid?sslmode=disable"
./audioguid
```

---

### ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€ĞµÑÑ‚Ğ°Ñ€Ñ‚ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸ÑÑ… (Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸)

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ air
go install github.com/cosmtrek/air@latest

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³
cat > .air.toml << 'EOF'
root = "."
tmp_dir = "tmp"

[build]
cmd = "go build -o ./tmp/main cmd/server/main.go"
bin = "tmp/main"
include_ext = ["go"]
exclude_dir = ["tmp", "vendor"]
EOF

# Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ hot-reload
air
```

---

## ğŸ“– ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 1: Ğ¡Ğ¾Ğ²ĞµÑ‚ÑĞºĞ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° (60 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

```bash
# Ğ¨Ğ°Ğ³ 1: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚
ROUTE=$(curl -s -X POST http://localhost:8080/api/routes/generate \
  -H "Content-Type: application/json" \
  -d '{
    "start_point": {"lat": 55.7558, "lon": 37.6173},
    "duration_minutes": 60,
    "epochs": ["soviet"],
    "interests": ["architecture"],
    "max_waypoints": 3
  }')

# Ğ¨Ğ°Ğ³ 2: ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ route_id
ROUTE_ID=$(echo $ROUTE | python3 -c "import sys,json; print(json.load(sys.stdin)['route_id'])")
echo "ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ½: $ROUTE_ID"

# Ğ¨Ğ°Ğ³ 3: ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ°Ñ‚ÑŒ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°
echo "Ğ–Ğ´ĞµĞ¼ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° (60 ÑĞµĞºÑƒĞ½Ğ´)..."
sleep 60

# Ğ¨Ğ°Ğ³ 4: ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚
curl -s http://localhost:8080/api/routes/$ROUTE_ID | python3 -m json.tool

# Ğ¨Ğ°Ğ³ 5: Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ°ÑƒĞ´Ğ¸Ğ¾ Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¸
WAYPOINT_ID=$(curl -s http://localhost:8080/api/routes/$ROUTE_ID | \
  python3 -c "import sys,json; print(json.load(sys.stdin)['waypoints'][0]['id'])")

curl http://localhost:8080/api/audio/$WAYPOINT_ID -o waypoint1.mp3
echo "ĞÑƒĞ´Ğ¸Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾: waypoint1.mp3"
```

---

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 2: ĞŸĞ¾Ğ¸ÑĞº Ğ±Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞ¸Ñ… Ğ¼ĞµÑÑ‚

```bash
# ĞĞ°Ğ¹Ñ‚Ğ¸ ÑĞ¾Ğ²ĞµÑ‚ÑĞºÑƒÑ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñƒ
curl -s "http://localhost:8080/api/pois?epoch=soviet&category=architecture" | \
  python3 -c "
import sys, json
data = json.load(sys.stdin)
for poi in data:
    print(f\"{poi['Name']}: {poi['Latitude']}, {poi['Longitude']}\")
"
```

**Ğ’Ñ‹Ğ²Ğ¾Ğ´:**
```
Ğ’Ğ”ĞĞ¥: 55.8304, 37.6325
ĞœĞ“Ğ£ Ğ¸Ğ¼. Ğœ.Ğ’. Ğ›Ğ¾Ğ¼Ğ¾Ğ½Ğ¾ÑĞ¾Ğ²Ğ°: 55.7033, 37.5297
ĞÑÑ‚Ğ°Ğ½ĞºĞ¸Ğ½ÑĞºĞ°Ñ Ñ‚ĞµĞ»ĞµĞ±Ğ°ÑˆĞ½Ñ: 55.8194, 37.6119
Ğ“Ğ¾ÑÑ‚Ğ¸Ğ½Ğ¸Ñ†Ğ° 'Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ğ°': 55.7526, 37.5676
```

---

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 3: Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ POI

```bash
# Ğ§ĞµÑ€ĞµĞ· psql
PGPASSWORD=<password> psql -h 51.250.86.178 -U nike -d audioguid << 'EOF'
INSERT INTO pois (name, description, latitude, longitude, epoch, category, importance, year_built)
VALUES (
  'ĞŸĞ°Ñ€Ğº ĞŸĞ¾Ğ±ĞµĞ´Ñ‹',
  'ĞœĞµĞ¼Ğ¾Ñ€Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑ Ğ¿Ğ¾Ğ±ĞµĞ´Ñ‹ Ğ² Ğ’ĞĞ’',
  55.7325,
  37.5086,
  'soviet',
  'history',
  9,
  1995
);
EOF
```

Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Python ÑĞºÑ€Ğ¸Ğ¿Ñ‚:
```python
# scripts/add_poi.py
import psycopg2

conn = psycopg2.connect(
    "postgresql://nike:<password>@51.250.86.178:<port>/audioguid"
)
cursor = conn.cursor()

cursor.execute("""
    INSERT INTO pois (name, description, latitude, longitude, epoch, category, importance)
    VALUES (%s, %s, %s, %s, %s, %s, %s)
""", (
    "ĞŸĞ°Ñ€Ğº ĞŸĞ¾Ğ±ĞµĞ´Ñ‹",
    "ĞœĞµĞ¼Ğ¾Ñ€Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑ",
    55.7325, 37.5086,
    "soviet", "history", 9
))

conn.commit()
print("âœ… POI Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½")
```

---

## ğŸ”§ Troubleshooting

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 1: "connection refused" Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞµ

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** PostgreSQL Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
PGPASSWORD=<password> psql -h 51.250.86.178 -U nike -d audioguid -c "SELECT 1;"

# Ğ•ÑĞ»Ğ¸ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ:
# 1. IP Ğ°Ğ´Ñ€ĞµÑ ÑĞµÑ€Ğ²ĞµÑ€Ğ° (51.250.86.178)
# 2. ĞŸĞ¾Ñ€Ñ‚ (<port>)
# 3. ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ (<password>)
# 4. Firewall rules Ğ½Ğ° VM
```

---

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 2: "Failed to create waypoints"

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° Ñ foreign key constraints

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ…ĞµĞ¼Ñƒ
PGPASSWORD=<password> psql -h 51.250.86.178 -U nike -d audioguid -c "\d waypoints"

# ĞŸĞµÑ€ĞµÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ constraint
PGPASSWORD=<password> psql -h 51.250.86.178 -U nike -d audioguid << 'EOF'
ALTER TABLE waypoints DROP CONSTRAINT IF EXISTS fk_waypoints_poi;
ALTER TABLE waypoints ADD CONSTRAINT fk_waypoints_poi 
  FOREIGN KEY (poi_id) REFERENCES pois(id);
EOF
```

---

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 3: "No POIs found"

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** ĞĞµÑ‚ POI Ğ² Ñ€Ğ°Ğ´Ğ¸ÑƒÑĞµ Ğ¿Ğ¾Ğ¸ÑĞºĞ°

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```bash
# 1. Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ duration_minutes (Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ñ€Ğ°Ğ´Ğ¸ÑƒÑ)
# 2. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑˆĞ¸Ñ€Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹ (Ğ±Ğ¾Ğ»ÑŒÑˆĞµ epochs Ğ¸ interests)
# 3. Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ start_point Ğ±Ğ»Ğ¸Ğ¶Ğµ Ğº POI

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ POI
curl -s http://localhost:8080/api/pois | python3 -m json.tool | grep -A2 -B2 "Name"
```

---

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 4: "YandexGPT API error"

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¸Ğ»Ğ¸ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ API ĞºĞ»ÑÑ‡Ğ¸

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
echo $YANDEX_API_KEY
echo $YANDEX_FOLDER_ID

# Ğ•ÑĞ»Ğ¸ Ğ¿ÑƒÑÑ‚Ñ‹Ğµ, ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ:
export YANDEX_API_KEY="AQVN..."
export YANDEX_FOLDER_ID="b1g..."

# Ğ˜Ğ»Ğ¸ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² .env Ñ„Ğ°Ğ¹Ğ»

# ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ API ĞºĞ»ÑÑ‡
curl -X POST https://llm.api.cloud.yandex.net/foundationModels/v1/completion \
  -H "Authorization: Api-Key $YANDEX_API_KEY" \
  -H "x-folder-id: $YANDEX_FOLDER_ID" \
  -H "Content-Type: application/json" \
  -d '{
    "modelUri": "gpt://'"$YANDEX_FOLDER_ID"'/yandexgpt/latest",
    "completionOptions": {"temperature": 0.7, "maxTokens": "100"},
    "messages": [{"role": "user", "text": "ĞŸÑ€Ğ¸Ğ²ĞµÑ‚!"}]
  }'
```

---

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 5: ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ Ğ½Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ´ĞµÑ‚ Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ğ¾, Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ°Ñ‚ÑŒ

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ñ‡ĞµÑ€ĞµĞ· 1-2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹
curl -s http://localhost:8080/api/routes/$ROUTE_ID | \
  python3 -c "
import sys, json
data = json.load(sys.stdin)
for wp in data['waypoints']:
    status = 'âœ…' if wp.get('content') else 'â³'
    print(f\"{status} {wp['name']}: {wp.get('content', 'Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ...')}\")
"
```

---

## ğŸ“Š ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° ÑĞµÑ€Ğ²ĞµÑ€Ğ°
```bash
curl http://localhost:8080/api/health
```

### ĞŸĞ¾Ğ´ÑÑ‡ĞµÑ‚ POI Ğ¿Ğ¾ ÑĞ¿Ğ¾Ñ…Ğ°Ğ¼
```bash
curl -s http://localhost:8080/api/pois | \
  python3 -c "
import sys, json
from collections import Counter
data = json.load(sys.stdin)
epochs = Counter(poi['Epoch'] for poi in data)
for epoch, count in epochs.items():
    print(f'{epoch}: {count}')
"
```

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
```bash
PGPASSWORD=<password> psql -h 51.250.86.178 -U nike -d audioguid -c "
SELECT
  tablename,
  pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;
"
```

### Ğ›Ğ¾Ğ³Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°
```bash
# Ğ’ ĞºĞ¾Ğ´Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
tail -f /tmp/audioguid.log
```

---

## ğŸ“ Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ

### Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸

- **Go 1.21+** - Ğ¯Ğ·Ñ‹Ğº Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- **Gin Web Framework** - HTTP Ñ€Ğ¾ÑƒÑ‚ĞµÑ€
- **GORM** - ORM Ğ´Ğ»Ñ PostgreSQL
- **PostgreSQL 16** - Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- **2GIS API** - ĞšĞ°Ñ€Ñ‚Ñ‹ Ğ¸ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹
- **YandexGPT** - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ°
- **Yandex SpeechKit** - Text-to-Speech

### ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ° |
|------------|----------|-------------|
| DATABASE_URL | Connection string PostgreSQL | âœ… |
| YANDEX_API_KEY | API ĞºĞ»ÑÑ‡ Yandex Cloud | âŒ* |
| YANDEX_FOLDER_ID | Folder ID Yandex Cloud | âŒ* |
| YANDEX_VOICE | Ğ“Ğ¾Ğ»Ğ¾Ñ TTS (alena, filipp) | âŒ |
| GAPIS_API_KEY | API ĞºĞ»ÑÑ‡ 2GIS | âœ… |
| PORT | ĞŸĞ¾Ñ€Ñ‚ ÑĞµÑ€Ğ²ĞµÑ€Ğ° (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 8080) | âŒ |

*Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹ Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°

### Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Go

```go
require (
    github.com/gin-gonic/gin v1.9.1
    github.com/google/uuid v1.4.0
    github.com/joho/godotenv v1.5.1
    github.com/lib/pq v1.10.9
    gorm.io/driver/postgres v1.5.4
    gorm.io/gorm v1.25.5
)
```

---

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°!** ğŸ‰

Ğ”Ğ»Ñ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼ ÑĞ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ğ¹Ñ‚Ğµ issue Ğ² Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸.
