# üìã –°–≤–æ–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ Audio Guide API

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### üéØ –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

1. **–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API** - `POST /api/routes/generate-audio`
   - –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å ‚Üí –≥–æ—Ç–æ–≤—ã–π MP3 —Ñ–∞–π–ª
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∞—É–¥–∏–æ –≤—Å–µ—Ö —Ç–æ—á–µ–∫

2. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API** - `POST /api/routes/generate`
   - –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
   - –§–æ–Ω–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   - –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

3. **Swagger UI** - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   - OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
   - PostgreSQL —Å PostGIS
   - 12 —Ç–µ—Å—Ç–æ–≤—ã—Ö POI
   - 4 —Ç–∞–±–ª–∏—Ü—ã (pois, routes, waypoints, contents)

### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–ü–æ—Ä—Ç –ë–î** - –û–±–Ω–æ–≤–ª–µ–Ω —Å 5432 –Ω–∞ 30101
2. **–°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
3. **TTS —Å–µ—Ä–≤–∏—Å** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∞

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **–ì–ª–∞–≤–Ω—ã–µ —Ñ–∞–π–ª—ã**
   - `README.md` - –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
   - `GETTING_STARTED.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É
   - `FINAL_SETUP.md` - –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (`docs/`)
   - `api/` - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - `guides/` - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
   - `reference/` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
   - `diagrams/` - –î–∏–∞–≥—Ä–∞–º–º—ã

3. **–£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã**
   - DOCUMENTATION_SUMMARY.md
   - QUICK_FIX_PORT.md
   - START_HERE.md
   - SWAGGER_SETUP.md

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
2gis_hackaton/
‚îú‚îÄ‚îÄ README.md                    # –ì–ª–∞–≤–Ω—ã–π –æ–±–∑–æ—Ä
‚îú‚îÄ‚îÄ GETTING_STARTED.md           # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É
‚îú‚îÄ‚îÄ FINAL_SETUP.md               # –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
‚îú‚îÄ‚îÄ PROJECT_SUMMARY.md           # –≠—Ç–∞ —Å–≤–æ–¥–∫–∞
‚îú‚îÄ‚îÄ .gitignore                   # –û–±–Ω–æ–≤–ª–µ–Ω
‚îÇ
‚îú‚îÄ‚îÄ backend/                     # Backend –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ cmd/server/main.go      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ + Swagger
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/                # HTTP handlers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/             # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database/           # –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ docs/                   # Swagger (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ config/config.yaml      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ docs/                        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ README.md               # –¶–µ–Ω—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ api/                    # API docs
‚îÇ   ‚îú‚îÄ‚îÄ guides/                 # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
‚îÇ   ‚îú‚îÄ‚îÄ reference/              # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ diagrams/               # –î–∏–∞–≥—Ä–∞–º–º—ã
‚îÇ
‚îú‚îÄ‚îÄ scripts/                     # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ import_sample_pois.py   # –ò–º–ø–æ—Ä—Ç POI
‚îÇ   ‚îî‚îÄ‚îÄ create_tables.sql       # SQL —Å—Ö–µ–º–∞
‚îÇ
‚îî‚îÄ‚îÄ tests/                       # –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
    ‚îú‚îÄ‚îÄ generate_audio_route.sh
    ‚îú‚îÄ‚îÄ test_route.sh
    ‚îî‚îÄ‚îÄ test_audio_guide.sh
```

---

## üéØ API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `GET` | `/api/health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ |
| `GET` | `/api/pois` | –°–ø–∏—Å–æ–∫ –º–µ—Å—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞ |
| `GET` | `/api/pois/:id` | –î–µ—Ç–∞–ª–∏ –º–µ—Å—Ç–∞ |
| `POST` | `/api/routes/generate` | –°–æ–∑–¥–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ) |
| `POST` | `/api/routes/generate-audio` | **–°–æ–∑–¥–∞—Ç—å + MP3 (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)** ‚ö° |
| `GET` | `/api/routes/:id` | –ü–æ–ª—É—á–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç |
| `GET` | `/api/routes/:id/audio` | –ü–æ–ª—É—á–∏—Ç—å –∞—É–¥–∏–æ–≥–∏–¥ |
| `GET` | `/api/audio/:waypoint_id` | –ü–æ–ª—É—á–∏—Ç—å –∞—É–¥–∏–æ —Ç–æ—á–∫–∏ |
| `GET` | `/swagger/*` | Swagger UI |

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~3000+
- **API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:** 9
- **POI –≤ –±–∞–∑–µ:** 12
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** 15+ —Ñ–∞–π–ª–æ–≤
- **Swagger –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π:** ~70
- **–¢–µ—Å—Ç–æ–≤—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤:** 3

---

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|-----------|
| Backend | Go 1.21+ |
| Web Framework | Gin |
| ORM | GORM |
| Database | PostgreSQL 16 + PostGIS |
| API Docs | Swagger/OpenAPI 3.0 |
| Maps | 2GIS API |
| Text Generation | YandexGPT |
| Audio | Yandex SpeechKit |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
export DATABASE_URL="postgresql://nike:changeme@51.250.86.178:30101/audioguid?sslmode=disable"
export YANDEX_API_KEY="your-key"
export YANDEX_FOLDER_ID="your-folder"

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
cd backend && go run cmd/server/main.go

# 3. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞—É–¥–∏–æ–≥–∏–¥
curl -X POST http://localhost:8080/api/routes/generate-audio \
  -d '{"start_point": {"lat": 55.7558, "lon": 37.6173}, "duration_minutes": 90, "max_waypoints": 3}' \
  -H "Content-Type: application/json" -o guide.mp3
```

---

## üìö –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
1. **[GETTING_STARTED.md](GETTING_STARTED.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
2. **[FINAL_SETUP.md](FINAL_SETUP.md)** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
3. **[docs/README.md](docs/README.md)** - –¶–µ–Ω—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
4. **[docs/api/SYNC_AUDIO_API.md](docs/api/SYNC_AUDIO_API.md)** - –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API
5. **[docs/api/AUDIO_GUIDE_API.md](docs/api/AUDIO_GUIDE_API.md)** - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API

### –î–ª—è –∏–∑—É—á–µ–Ω–∏—è
6. **[docs/reference/–ü–û–õ–ù–ê–Ø_–î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø.md](docs/reference/–ü–û–õ–ù–ê–Ø_–î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø.md)** - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
7. **[docs/diagrams/–î–ò–ê–ì–†–ê–ú–ú–´.md](docs/diagrams/–î–ò–ê–ì–†–ê–ú–ú–´.md)** - –í–∏–∑—É–∞–ª—å–Ω—ã–µ —Å—Ö–µ–º—ã

---

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API
- ‚úÖ –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å ‚Üí MP3 —Ñ–∞–π–ª
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚è±Ô∏è –í—Ä–µ–º—è: 2-5 –º–∏–Ω—É—Ç

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π API
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç (route_id)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
- ‚úÖ –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- ‚è±Ô∏è –í—Ä–µ–º—è: –º–≥–Ω–æ–≤–µ–Ω–Ω–æ + —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### Swagger UI
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ –∫–æ–¥–∞
- ‚úÖ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
- üîó http://localhost:8080/swagger/index.html

---

## üéì –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### cURL

```bash
curl -X POST http://localhost:8080/api/routes/generate-audio \
  -H "Content-Type: application/json" \
  -d '{
    "start_point": {"lat": 55.7558, "lon": 37.6173},
    "duration_minutes": 90,
    "epochs": ["soviet", "medieval"],
    "interests": ["architecture", "history"],
    "max_waypoints": 3
  }' \
  -o route_guide.mp3
```

### JavaScript

```javascript
const response = await fetch('http://localhost:8080/api/routes/generate-audio', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    start_point: { lat: 55.7558, lon: 37.6173 },
    duration_minutes: 90,
    max_waypoints: 3
  })
});

const blob = await response.blob();
const url = URL.createObjectURL(blob);
const audio = new Audio(url);
audio.play();
```

### Python

```python
import requests

response = requests.post(
    'http://localhost:8080/api/routes/generate-audio',
    json={
        'start_point': {'lat': 55.7558, 'lon': 37.6173},
        'duration_minutes': 90,
        'max_waypoints': 3
    }
)

with open('route_guide.mp3', 'wb') as f:
    f.write(response.content)
```

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

### –ü—Ä–æ–µ–∫—Ç
- [README.md](README.md) - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- [GETTING_STARTED.md](GETTING_STARTED.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- [Swagger UI](http://localhost:8080/swagger/index.html) - API docs

### –í–Ω–µ—à–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã
- [2GIS API](https://docs.2gis.com/)
- [YandexGPT](https://cloud.yandex.ru/docs/yandexgpt/)
- [Yandex SpeechKit](https://cloud.yandex.ru/docs/speechkit/)

---

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ:

- ‚úÖ Swagger UI —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ POI –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ .gitignore –æ–±–Ω–æ–≤–ª–µ–Ω

**–ù–∞—á–Ω–∏—Ç–µ —Å:** [GETTING_STARTED.md](GETTING_STARTED.md)

---

<div align="center">
  <b>–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–∞ 2GIS</b>
  <br>
  <sub>–£–º–Ω—ã–µ –∞—É–¥–∏–æ–º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã—Ö –ø—Ä–æ–≥—É–ª–æ–∫</sub>
</div>
